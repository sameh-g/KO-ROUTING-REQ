!function(t){"use strict";function e(t,e,n,i,s,r,u){this.inputItem=e,this.stateArrayIndex=n,this.mappingOptions=s,this.arrayOfState=r,this.outputObservableArray=u,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=t.observable(i),this.mappedValueComputed=t.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function n(t,e){if(!t)return null;switch(t.status){case"added":return t.index;case"deleted":return t.index+e;default:throw new Error("Unknown diff status: "+t.status)}}function i(t,n,i,s,r,u,a,o,p){var d="number"==typeof n.moved,l=d?i[n.moved]:new e(t,n.value,s,r,u,a,o);return a.splice(s,0,l),l.isIncluded&&p.splice(r,0,l.mappedValueComputed.peek()),d&&(l.stateArrayIndex=s,l.setOutputArrayIndexSilently(r)),l}function s(t,e,n,i,s){var r=e.splice(n,1)[0];r.isIncluded&&s.splice(i,1),"number"!=typeof t.moved&&r.dispose()}function r(t,e,n){return t.stateArrayIndex=e,t.setOutputArrayIndexSilently(n),n+(t.isIncluded?1:0)}function u(t,e){for(var n={},i=0;i<t.length;i++){var s=t[i];"added"===s.status&&"number"==typeof s.moved&&(n[s.moved]=e[s.moved])}return n}function a(t,e,n){return n.length&&e[t.index]?e[t.index].outputArrayIndex.peek():n.length}function o(t,e,o,p,d,l){return e.subscribe(function(e){if(e.length){for(var c=u(e,o),h=0,f=e[0],y=0,m=f&&a(f,o,p),v=f.index;f||v<o.length;v++)if(n(f,y)===v){switch(f.status){case"added":var I=i(t,f,c,v,m,l,o,d,p);I.isIncluded&&m++,y++;break;case"deleted":s(f,o,v,m,p),y--,v--;break;default:throw new Error("Unknown diff status: "+f.status)}h++,f=e[h]}else v<o.length&&(m=r(o[v],v,m));d.valueHasMutated()}},null,"arrayChange")}function p(t,n){var i=this,s=[],r=[],u=t.observableArray(r),a=i.peek();"function"==typeof n&&(n={mapping:n});for(var p=0;p<a.length;p++){var d=a[p],l=new e(t,d,p,r.length,n,s,u),h=l.mappedValueComputed.peek();s.push(l),l.isIncluded&&r.push(h)}var f=o(t,i,s,r,u,n),y=t.computed(u).extend({trackArrayChanges:!0}),m=y.dispose;return y.dispose=function(){f.dispose(),t.utils.arrayForEach(s,function(t){t.dispose()}),m.call(this,arguments)},c(t,y),y}function d(t,e){return p.call(this,t,function(t){return e(t)?t:y})}function l(t){function e(t,e){return function(){return e.apply(this,[t].concat(Array.prototype.slice.call(arguments,0)))}}t[m]={map:e(t,p),filter:e(t,d)}}function c(t,e){return t.utils.extend(e,t[m]),e}function h(t){t.projections={_exclusionMarker:y},l(t),c(t,t.observableArray.fn)}function f(){if("undefined"!=typeof module&&"undefined"!=typeof module.exports){var e=require("knockout");h(e),module.exports=e}else"function"==typeof define&&define.amd?define(["knockout"],h):"ko"in t&&h(t.ko)}var y={};e.prototype.dispose=function(){var t=this.mappedValueComputed();this.mappedValueComputed.dispose(),this.mappingOptions.disposeItem&&this.mappingOptions.disposeItem(t)},e.prototype.mappingEvaluator=function(){var t=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex),e=t!==y;return this.isIncluded!==e&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(e),this.isIncluded=e),t},e.prototype.onMappingResultChanged=function(t){t!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,t),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=t)},e.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(t){var e,n,i=this.outputArrayIndex.peek();if(t)for(this.outputArray.splice(i,0,null),e=this.stateArrayIndex+1;e<this.arrayOfState.length;e++)n=this.arrayOfState[e],n.setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(i,1),e=this.stateArrayIndex+1;e<this.arrayOfState.length;e++)n=this.arrayOfState[e],n.setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},e.prototype.setOutputArrayIndexSilently=function(t){this.suppressNotification=!0,this.outputArrayIndex(t),this.suppressNotification=!1};var m="_ko.projections.cache";f()}(this);